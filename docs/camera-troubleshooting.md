# カメラ機能 トラブルシューティングガイド

## 概要

ID verifyのカメラ機能で問題が発生した場合の対処法を説明します。

## よくある問題と解決方法

### 1. カメラが起動しない

#### 症状
- 「カメラ起動」ボタンを押しても何も起こらない
- エラーメッセージが表示される

#### 原因と解決方法

**A. ブラウザの権限設定**
```
エラー: NotAllowedError
```
- ブラウザの設定でカメラ権限が拒否されている
- 解決方法:
  1. ブラウザのアドレスバー横のカメラアイコンをクリック
  2. 「許可」を選択
  3. ページを再読み込み

**B. HTTPS接続が必要**
```
エラー: getUserMedia() not supported
```
- カメラ機能はHTTPS接続でのみ動作
- 解決方法:
  1. `https://` でアクセスしているか確認
  2. ローカル開発の場合は `http://localhost` でも動作

**C. 他のアプリケーションでカメラ使用中**
```
エラー: NotReadableError
```
- 他のアプリケーション（Zoom、Teams等）でカメラを使用中
- 解決方法:
  1. 他のアプリケーションを終了
  2. ブラウザを再起動

### 2. 撮影ができない

#### 症状
- カメラは起動するが撮影ボタンが反応しない
- 撮影後も画像が表示されない

#### 原因と解決方法

**A. キャンバス要素の問題**
- ブラウザのコンソールでエラーを確認
- 解決方法:
  1. ブラウザを再起動
  2. 別のブラウザで試す

**B. メモリ不足**
- 大きな画像の処理でメモリ不足
- 解決方法:
  1. ブラウザを再起動
  2. 他のタブを閉じる

### 3. 画像がぼやけている

#### 症状
- 撮影した画像が不鮮明
- 文字が読み取れない

#### 解決方法

**A. 撮影時の注意点**
- カメラを安定して保持
- 十分な明るさを確保
- 反射を避ける

**B. カメラ設定の調整**
- 高解像度カメラを使用
- 自動フォーカス機能を活用

## ブラウザ別の対応

### Chrome
- 最も安定した動作
- 推奨ブラウザ

### Firefox
- 基本的に動作
- 権限設定が厳しい場合がある

### Safari
- macOS/iOSで動作
- 権限設定を確認

### Edge
- Chromeベースで安定動作

## デバッグツール

### 1. カメラテストページ
```
/camera-test
```
- ブラウザのサポート状況確認
- カメラ権限の確認
- 利用可能なカメラの一覧表示

### 2. ブラウザの開発者ツール
- F12キーでコンソールを開く
- エラーメッセージを確認

### 3. カメラ権限の確認
```javascript
// ブラウザコンソールで実行
navigator.permissions.query({name: 'camera'})
  .then(result => console.log(result.state))
```

## 技術的な詳細

### 必要なAPI
- `navigator.mediaDevices.getUserMedia()`
- `navigator.permissions.query()`
- `HTMLCanvasElement.toDataURL()`

### 対応ブラウザ
- Chrome 53+
- Firefox 36+
- Safari 11+
- Edge 12+

### セキュリティ要件
- HTTPS接続必須
- ユーザーによる権限許可が必要

## サポート

問題が解決しない場合は、以下を確認してください：

1. **ブラウザのバージョン**: 最新版を使用
2. **OSの更新**: システムを最新に更新
3. **カメラドライバー**: カメラドライバーを更新
4. **別のブラウザ**: 別のブラウザで試す
5. **別のデバイス**: 別のデバイスで試す

## 更新履歴

- v1.0.0: 初期リリース
  - 基本的なカメラ機能
  - エラーハンドリングの改善
  - デバッグツールの追加 