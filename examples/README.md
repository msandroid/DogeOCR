# Doge OCR - ä¸–ç•Œå¯¾å¿œæ–‡æ›¸èªè­˜ã‚·ã‚¹ãƒ†ãƒ 

## æ¦‚è¦

Doge OCRã¯ã€ä¸–ç•Œä¸­ã®ã‚ã‚‰ã‚†ã‚‹æ–‡æ›¸ã«å¯¾å¿œã™ã‚‹åŒ…æ‹¬çš„ãªOCRï¼ˆå…‰å­¦æ–‡å­—èªè­˜ï¼‰ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚AIæŠ€è¡“ã‚’æ´»ç”¨ã—ã¦ã€ç”»åƒã‹ã‚‰æ–‡å­—ã‚’æŠ½å‡ºã—ã€æ–‡æ›¸ã®ç¨®é¡ã«å¿œã˜ã¦JSONå½¢å¼ã§æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’æä¾›ã—ã¾ã™ã€‚

## å¯¾å¿œæ–‡æ›¸ã‚¿ã‚¤ãƒ—

### ğŸ›ï¸ æ”¿åºœãƒ»å…¬çš„æ–‡æ›¸
- **èº«åˆ†è¨¼æ˜æ›¸**: ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã€é‹è»¢å…è¨±è¨¼ã€å›½æ°‘IDã‚«ãƒ¼ãƒ‰ã€åœ¨ç•™ã‚«ãƒ¼ãƒ‰ã€ã‚°ãƒªãƒ¼ãƒ³ã‚«ãƒ¼ãƒ‰ç­‰
- **æˆ¸ç±ãƒ»ä½æ°‘é–¢é€£**: å‡ºç”Ÿè¨¼æ˜æ›¸ã€å©šå§»è¨¼æ˜æ›¸ã€ä½æ°‘ç¥¨ã€æˆ¸ç±è¬„æœ¬ç­‰
- **ç¨å‹™ãƒ»å¹´é‡‘**: ç´ç¨è¨¼æ˜æ›¸ã€å¹´é‡‘æ‰‹å¸³ã€ç¤¾ä¼šä¿é™ºè¨¼ç­‰
- **è¨±å¯è¨¼ãƒ»å…è¨±**: å„ç¨®å–¶æ¥­è¨±å¯è¨¼ã€åŒ»å¸«å…è¨±ã€å¼è­·å£«è³‡æ ¼è¨¼ç­‰

### ğŸ’° é‡‘èãƒ»ä¿é™ºæ–‡æ›¸
- **éŠ€è¡Œé–¢é€£**: éŠ€è¡Œæ˜ç´°æ›¸ã€é€šå¸³ã€èè³‡å¥‘ç´„æ›¸ã€ä½å®…ãƒ­ãƒ¼ãƒ³æ–‡æ›¸ç­‰
- **ä¿é™ºé–¢é€£**: ä¿é™ºè¨¼åˆ¸ã€ä¿é™ºè«‹æ±‚æ›¸ã€å¥åº·ä¿é™ºè¨¼ç­‰
- **æŠ•è³‡é–¢é€£**: æ ªåˆ¸ã€å‚µåˆ¸ã€æŠ•è³‡æ˜ç´°æ›¸ç­‰

### âš–ï¸ æ³•å¾‹ãƒ»å¸æ³•æ–‡æ›¸
- **å¥‘ç´„æ›¸**: å£²è²·å¥‘ç´„æ›¸ã€è³ƒè²¸å¥‘ç´„æ›¸ã€é›‡ç”¨å¥‘ç´„æ›¸ã€ç§˜å¯†ä¿æŒå¥‘ç´„æ›¸ç­‰
- **æ³•å»·æ–‡æ›¸**: åˆ¤æ±ºæ–‡ã€è£åˆ¤æ‰€å‘½ä»¤ã€å¬å–šçŠ¶ã€å®£èª“ä¾›è¿°æ›¸ç­‰
- **å…¬è¨¼æ–‡æ›¸**: å…¬è¨¼æ–‡æ›¸ã€èªè¨¼è¬„æœ¬ç­‰

### ğŸ¥ åŒ»ç™‚ãƒ»å¥åº·æ–‡æ›¸
- **è‡¨åºŠæ–‡æ›¸**: è¨ºæ–­æ›¸ã€å‡¦æ–¹ç®‹ã€è¨ºç™‚è¨˜éŒ²ã€å¥åº·è¨ºæ–­çµæœç­‰
- **åŒ»ç™‚è²»é–¢é€£**: åŒ»ç™‚è²»æ˜ç´°æ›¸ã€ä¿é™ºè«‹æ±‚æ›¸ç­‰

### ğŸ“ æ•™è‚²ãƒ»è³‡æ ¼æ–‡æ›¸
- **è¨¼æ˜æ›¸**: å’æ¥­è¨¼æ˜æ›¸ã€å­¦ä½è¨˜ã€æˆç¸¾è¨¼æ˜æ›¸ç­‰
- **è³‡æ ¼é–¢é€£**: å„ç¨®è³‡æ ¼è¨¼æ˜æ›¸ã€ç ”ä¿®ä¿®äº†è¨¼ç­‰

### ğŸ¢ ä¼æ¥­ãƒ»æ¥­å‹™æ–‡æ›¸
- **è²¡å‹™è«¸è¡¨**: è²¸å€Ÿå¯¾ç…§è¡¨ã€æç›Šè¨ˆç®—æ›¸ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼è¨ˆç®—æ›¸ç­‰
- **å•†å–å¼•**: è«‹æ±‚æ›¸ã€ãƒ¬ã‚·ãƒ¼ãƒˆã€æ³¨æ–‡æ›¸ã€è¦‹ç©æ›¸ã€ç´å“æ›¸ç­‰
- **äººäº‹é–¢é€£**: å±¥æ­´æ›¸ã€çµ¦ä¸æ˜ç´°ã€å‹¤æ€ ç®¡ç†è¡¨ç­‰

### ğŸ’» ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ»æŠ€è¡“æ–‡æ›¸
- **æŠ€è¡“æ–‡æ›¸**: APIæ–‡æ›¸ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã€æŠ€è¡“ä»•æ§˜æ›¸ç­‰
- **ã‚¦ã‚§ãƒ–é–¢é€£**: ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã€åˆ©ç”¨è¦ç´„ç­‰

## ä¸»ãªæ©Ÿèƒ½

### ğŸ¯ é«˜ç²¾åº¦OCR
- Fireworks AI OCR ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨
- å¤šè¨€èªå¯¾å¿œï¼ˆæ—¥æœ¬èªã€è‹±èªã€ä¸­å›½èªã€éŸ“å›½èªç­‰ï¼‰
- æ–‡æ›¸æ§‹é€ ã®è‡ªå‹•åˆ†æ

### ğŸ” è‡ªå‹•æ–‡æ›¸åˆ†é¡
- AI ã«ã‚ˆã‚‹æ–‡æ›¸ç¨®é¡ã®è‡ªå‹•æ¤œå‡º
- 120+ ç¨®é¡ã®æ–‡æ›¸ã‚¿ã‚¤ãƒ—ã«å¯¾å¿œ
- åœ°åŸŸåˆ¥æœ€é©åŒ–ï¼ˆæ—¥æœ¬ã€ç±³å›½ã€EUã€ã‚¤ãƒ³ãƒ‰ç­‰ï¼‰

### ğŸ“Š æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
- æ–‡æ›¸ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸå°‚ç”¨ã‚¹ã‚­ãƒ¼ãƒ
- JSONå½¢å¼ã§ã®æ§‹é€ åŒ–å‡ºåŠ›
- ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åˆ¥ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢

### âœ… ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ãƒ»å“è³ªç®¡ç†
- Zodã‚¹ã‚­ãƒ¼ãƒã«ã‚ˆã‚‹å³å¯†ãªæ¤œè¨¼
- å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å®Œæˆåº¦ãƒã‚§ãƒƒã‚¯
- æ”¹å–„ææ¡ˆã®è‡ªå‹•ç”Ÿæˆ

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹

#### Node.js ã§ã®ä½¿ç”¨

```javascript
import { handleImageUpload } from './app/actions/demo.js'

// ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™
const formData = new FormData()
formData.append('image', imageFile)
formData.append('language', 'ja')  // ja, en, zh, koç­‰
formData.append('documentHint', 'ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ')  // ã‚ªãƒ—ã‚·ãƒ§ãƒ³

// OCRå®Ÿè¡Œ
const result = await handleImageUpload(
  { imagePreview: null, ocrResult: null },
  formData
)

console.log(result.ocrResult)
```

#### Python ã§ã®ä½¿ç”¨

```python
import requests
import base64

# ç”»åƒã‚’Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
with open('document.jpg', 'rb') as f:
    image_data = base64.b64encode(f.read()).decode()

# APIå‘¼ã³å‡ºã—
response = requests.post('http://localhost:3000/api/ocr', json={
    'image': f'data:image/jpeg;base64,{image_data}',
    'language': 'ja',
    'documentType': 'ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ'
})

result = response.json()
print(result)
```

### é«˜åº¦ãªæ©Ÿèƒ½

#### æ–‡æ›¸ã‚¿ã‚¤ãƒ—æ¤œå‡ºã®ã¿

```javascript
import { detectDocumentTypeFromImage } from './app/actions/demo.js'

const detection = await detectDocumentTypeFromImage(imageBase64)
console.log(`æ–‡æ›¸ã‚¿ã‚¤ãƒ—: ${detection.documentType}`)
console.log(`ä¿¡é ¼åº¦: ${detection.confidence}`)
console.log(`ã‚«ãƒ†ã‚´ãƒª: ${detection.category}`)
```

#### ãƒãƒƒãƒå‡¦ç†ï¼ˆè¤‡æ•°ç”»åƒï¼‰

```javascript
import { handleMultipleImages } from './app/actions/demo.js'

const files = [file1, file2, file3]  // File ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—
const results = await handleMultipleImages(files)

results.forEach((result, index) => {
  console.log(`ãƒ•ã‚¡ã‚¤ãƒ« ${index + 1}: ${result.filename}`)
  console.log('OCRçµæœ:', result.ocrResult)
})
```

#### ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼

```javascript
import { validateDocumentData } from './app/actions/demo.js'

const validation = await validateDocumentData('ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ', extractedData)
console.log(`æ¤œè¨¼çµæœ: ${validation.isValid}`)
console.log(`å®Œæˆåº¦: ${validation.completeness * 100}%`)
console.log('ã‚¨ãƒ©ãƒ¼:', validation.errors)
console.log('è­¦å‘Š:', validation.warnings)
```

## å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

### åŸºæœ¬å‡ºåŠ›æ§‹é€ 

```json
{
  "extractedText": "ç”Ÿã®OCRãƒ†ã‚­ã‚¹ãƒˆ",
  "documentType": "ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ",
  "documentCategory": "GOVERNMENT.IDENTITY",
  "structuredData": {
    "passport_number": "AB1234567",
    "surname": "YAMADA",
    "given_names": "TARO",
    "nationality": "JPN",
    "date_of_birth": "01 JAN 1990",
    "date_of_expiry": "01 JAN 2030"
  },
  "processingTime": 2340,
  "apiVersion": "v2.0",
  "confidence": 0.92,
  "language": "ja",
  "documentStructure": {
    "hasTable": false,
    "hasSignature": true,
    "hasPhoto": true,
    "hasBarcode": false,
    "structure": "certificate"
  },
  "fieldConfidence": {
    "passport_number": 0.95,
    "surname": 0.88,
    "given_names": 0.90
  },
  "recommendations": [
    "ç”»åƒã®è§£åƒåº¦ã‚’ä¸Šã’ã‚‹ã¨èªè­˜ç²¾åº¦ãŒå‘ä¸Šã—ã¾ã™"
  ]
}
```

### æ–‡æ›¸ã‚¿ã‚¤ãƒ—åˆ¥ã‚¹ã‚­ãƒ¼ãƒä¾‹

#### ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ

```json
{
  "passport_number": "ãƒ‘ã‚¹ãƒãƒ¼ãƒˆç•ªå·",
  "surname": "å§“",
  "given_names": "å",
  "nationality": "å›½ç±",
  "date_of_birth": "ç”Ÿå¹´æœˆæ—¥",
  "place_of_birth": "å‡ºç”Ÿåœ°",
  "sex": "æ€§åˆ¥",
  "date_of_issue": "ç™ºè¡Œæ—¥",
  "date_of_expiry": "æœ‰åŠ¹æœŸé™",
  "issuing_authority": "ç™ºè¡Œæ©Ÿé–¢",
  "mrz_Doge1": "MRZç¬¬1è¡Œ",
  "mrz_Doge2": "MRZç¬¬2è¡Œ"
}
```

#### è«‹æ±‚æ›¸

```json
{
  "invoice_number": "è«‹æ±‚æ›¸ç•ªå·",
  "invoice_date": "è«‹æ±‚æ—¥",
  "due_date": "æ”¯æ‰•æœŸé™",
  "vendor": {
    "name": "è«‹æ±‚å…ƒä¼šç¤¾å",
    "address": "ä½æ‰€",
    "tax_id": "ç¨å‹™ID"
  },
  "items": [
    {
      "description": "é …ç›®èª¬æ˜",
      "quantity": "æ•°é‡",
      "unit_price": "å˜ä¾¡",
      "total_price": "åˆè¨ˆé‡‘é¡"
    }
  ],
  "total_amount": "ç·é¡",
  "currency": "é€šè²¨"
}
```

#### è¨ºæ–­æ›¸

```json
{
  "patient_name": "æ‚£è€…å",
  "diagnosis_date": "è¨ºæ–­æ—¥",
  "doctor_name": "åŒ»å¸«å",
  "medical_facility": "åŒ»ç™‚æ©Ÿé–¢",
  "diagnosis": "è¨ºæ–­å",
  "treatment": "æ²»ç™‚å†…å®¹",
  "prescribed_medication": [
    {
      "medication": "è–¬å‰¤å",
      "dosage": "ç”¨é‡",
      "frequency": "æœç”¨é »åº¦"
    }
  ],
  "icd_10_code": "ICD-10ã‚³ãƒ¼ãƒ‰"
}
```

## API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### POST /api/ocr

åŸºæœ¬çš„ãªOCRå‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "image": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQ...",
  "language": "ja",
  "documentHint": "ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "success": true,
  "data": {
    "extractedText": "...",
    "documentType": "ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ",
    "structuredData": {...}
  }
}
```

### POST /api/ocr/detect

æ–‡æ›¸ã‚¿ã‚¤ãƒ—ã®æ¤œå‡ºã®ã¿ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

### POST /api/ocr/batch

è¤‡æ•°ç”»åƒã®ä¸€æ‹¬å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

### POST /api/ocr/validate

æŠ½å‡ºãƒ‡ãƒ¼ã‚¿ã®æ¤œè¨¼ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

## è¨­å®š

### ç’°å¢ƒå¤‰æ•°

```bash
# å¿…é ˆ
FIREWORKS_API_KEY=your_fireworks_api_key

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³
OCR_MAX_FILE_SIZE=10MB
OCR_SUPPORTED_FORMATS=jpg,png,gif,webp
OCR_DEFAULT_LANGUAGE=ja
```

### å¯¾å¿œç”»åƒå½¢å¼

- JPEG (.jpg, .jpeg)
- PNG (.png)
- GIF (.gif)
- WebP (.webp)

### ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™

- æœ€å¤§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: 10MB
- æ¨å¥¨è§£åƒåº¦: 300 DPIä»¥ä¸Š
- æœ€å°ã‚µã‚¤ã‚º: 200x200 ãƒ”ã‚¯ã‚»ãƒ«

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºæ–¹æ³•

#### 1. æ–‡æ›¸ã‚¿ã‚¤ãƒ—ãŒã€Œä¸æ˜ã€ã«ãªã‚‹

**åŸå› :**
- ç”»åƒã®è§£åƒåº¦ãŒä½ã„
- æ–‡å­—ãŒä¸é®®æ˜
- å¯¾å¿œã—ã¦ã„ãªã„æ–‡æ›¸ã‚¿ã‚¤ãƒ—

**è§£æ±ºæ–¹æ³•:**
```javascript
// ã‚ˆã‚Šé«˜è§£åƒåº¦ã®ç”»åƒã‚’ä½¿ç”¨
// documentHint ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æ–‡æ›¸ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®š
formData.append('documentHint', 'é©åˆ‡ãªæ–‡æ›¸ã‚¿ã‚¤ãƒ—')
```

#### 2. æŠ½å‡ºç²¾åº¦ãŒä½ã„

**åŸå› :**
- ç”»åƒã®å‚¾ãã‚„æ­ªã¿
- ç…§æ˜ä¸è¶³
- èƒŒæ™¯ã®ãƒã‚¤ã‚º

**è§£æ±ºæ–¹æ³•:**
- ç”»åƒã‚’æ­£é¢ã‹ã‚‰æ’®å½±
- ååˆ†ãªç…§æ˜ã‚’ç¢ºä¿
- èƒŒæ™¯ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã«ä¿ã¤

#### 3. APIã‚¨ãƒ©ãƒ¼

**åŸå› :**
- APIã‚­ãƒ¼ã®è¨­å®šä¸å‚™
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®è¶…é
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å•é¡Œ

**è§£æ±ºæ–¹æ³•:**
```bash
# APIã‚­ãƒ¼ã®ç¢ºèª
echo $FIREWORKS_API_KEY

# ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®ç¢ºèª
curl -H "Authorization: Bearer $FIREWORKS_API_KEY" https://api.fireworks.ai/v1/usage
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### ç”»åƒå‰å‡¦ç†

```javascript
// ç”»åƒã‚’æœ€é©åŒ–ã—ã¦ã‹ã‚‰OCRå®Ÿè¡Œ
function preprocessImage(imageFile) {
  return new Promise((resolve) => {
    const canvas = document.createElement('canvas')
    const ctx = canvas.getContext('2d')
    const img = new Image()
    
    img.onload = () => {
      // ãƒªã‚µã‚¤ã‚ºã¨æœ€é©åŒ–
      canvas.width = Math.min(img.width, 2048)
      canvas.height = Math.min(img.height, 2048)
      
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height)
      canvas.toBlob(resolve, 'image/jpeg', 0.9)
    }
    
    img.src = URL.createObjectURL(imageFile)
  })
}
```

### ãƒãƒƒãƒå‡¦ç†ã®æœ€é©åŒ–

```javascript
// ä¸¦åˆ—å‡¦ç†ã§é«˜é€ŸåŒ–
async function processMultipleImagesOptimized(files) {
  const batches = []
  const batchSize = 3  // åŒæ™‚å‡¦ç†æ•°ã®åˆ¶é™
  
  for (let i = 0; i < files.length; i += batchSize) {
    batches.push(files.slice(i, i + batchSize))
  }
  
  const results = []
  for (const batch of batches) {
    const batchResults = await Promise.all(
      batch.map(file => handleImageUpload({}, createFormData(file)))
    )
    results.push(...batchResults)
  }
  
  return results
}
```

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ã‚µãƒãƒ¼ãƒˆ

æŠ€è¡“çš„ãªè³ªå•ã‚„ãƒã‚°å ±å‘Šã¯ã€GitHubã®Issuesãƒšãƒ¼ã‚¸ã¾ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚

## æ›´æ–°å±¥æ­´

### v2.0.0 (2024-01-15)
- ä¸–ç•Œå¯¾å¿œæ–‡æ›¸ã‚¿ã‚¤ãƒ—ã®è¿½åŠ ï¼ˆ120+ ç¨®é¡ï¼‰
- å¤šè¨€èªOCRå¯¾å¿œ
- é«˜åº¦ãªãƒ‡ãƒ¼ã‚¿æ¤œè¨¼æ©Ÿèƒ½
- ãƒãƒƒãƒå‡¦ç†æ©Ÿèƒ½
- æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã®ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢

### v1.0.0 (2023-12-01)  
- åŸºæœ¬OCRæ©Ÿèƒ½
- æ—¥æœ¬èªæ–‡æ›¸å¯¾å¿œ
- JSONæ§‹é€ åŒ–å‡ºåŠ› 